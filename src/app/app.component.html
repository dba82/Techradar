
<svg viewBox="-2000 -1000 5000 4000" #svg>
  <g db-ringsegment 
    [endAngle]="360" 
    [innerRadius]="0" 
    [outerRadius]="1000"
    [x]="1000"
    [y]="1000"
    dbRingsegmentContainer="row">

    <g *ngFor="let sector of dataService.data | keyvalue; index as i;" 
      class="sector"  
      db-ringsegment 
      dbRelativeSize
      dbGeometry
      dbRingsegmentContainer="column"
      dbDragzone

      #rs="db-ringsegment"
      #grs="dbGeometry"
      #dz="dbDragzone"
      >

      <foreignObject 
      [attr.x]="grs.adjacentBox(1200,40).x" 
      [attr.y]="grs.adjacentBox(1200,40).y" 
      [attr.width]="1200"
      [attr.height]="grs.height">
        <db-tech-sector-lists [sector]="sector"></db-tech-sector-lists>
      </foreignObject>
      
      <g *ngFor="let section of dataService.states;" 
        db-ringsegment 
        dbRelativeSize 
        [dbDropzone]="dz"
        (dropped)="update($event, sector.value[section])"
        [dbGrid]="rs.outerRadius/50" 

        #grid="grid">

        <g *ngIf="showGrid">
          <circle 
            *ngFor="let p of grid.points" 
            [attr.cx]="p[0].x" 
            [attr.cy]="p[0].y" 
            r="0.1">
          </circle>
        </g>

        <g *ngFor="let item of sector.value[section]; index as i;"
          dbGridItem 
          #gi="gridItem"
          [ngbTooltip]="item?.name"
          container="body"
          triggers="mouseenter:mouseleave"
          (mouseenter)="item!.selected = true"
          (mouseleave)="item!.selected = false"
          [dbDraggable]="dz"
          [itemData] = "item"
          >

          <circle 
            [attr.cx]="gi.position?.x" 
            [attr.cy]="gi.position?.y" 
            [attr.r]="grid.elementRadius"
            class="{{section}}"
            >
          </circle>
          <text 
            class="icon-number"
            [attr.x]="gi.position?.x" 
            [attr.y]="gi.position?.y" 
            [style]="{'font-size': +grid.elementRadius}"
          > 
            {{item?.number}}
          </text>
        </g>
      </g>
    </g>
  </g>
</svg>
